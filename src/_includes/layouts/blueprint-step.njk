{% extends "layouts/base.njk" %}

{% set bodyClass = "page page--blueprint-step" %}

{% block content %}
<div class="content flow">
    {{ content | safe }}
</div>
<nav class="pagination flow" aria-label="pagination">
    {% if 'blueprint-consultants' in tags %}
    {% set correspondingStep = false %}
    {% for item in collections["blueprint-entities"] %}
        {% if item.data.step === step %}
        {% set correspondingStep = item %}
        {% endif %}
    {% endfor %}
    <p><a href="{{ correspondingStep.url }}">What's happening for entities</a></p>
    {% elif 'blueprint-entities' in tags %}
    {% set correspondingStep = false %}
    {% for item in collections["blueprint-consultants"] %}
        {% if item.data.step === step %}
        {% set correspondingStep = item %}
        {% endif %}
    {% endfor %}
    <p><a href="{{ correspondingStep.url }}">What's happening for consultants</a></p>
    {% endif %}
    
    {% set previousStep = collections[tags[0]] | getPreviousCollectionItem(page) %}
    {% set nextStep = collections[tags[0]] | getNextCollectionItem(page) %}

    {% set who = 'consultants and entities' %}

    {% if 'blueprint-consultants' in tags %}
        {% set who = 'consultants' %}
    {% elif 'blueprint-entities' in tags %}
        {% set who = 'entities' %}
    {% endif %}

    <ul role="list">
    {%- if previousStep %}
        <li><a href="{{ previousStep.url }}"><span aria-hidden="true">&larr;</span> Previous step for {{ who }}</a></li>
    {%- elif 'blueprint-both' in tags %}
        <li><a href="{{ collections['blueprint-consultants'][collections['blueprint-consultants'].length - 1].url }}"><span aria-hidden="true">&larr;</span> Previous step for consultants</a></li>
        <li><a href="{{ collections['blueprint-entities'][collections['blueprint-consultants'].length - 1].url }}"><span aria-hidden="true">&larr;</span> Previous step for entities</a></li>
    {%- endif %}
    {%- if nextStep %}
        <li><a href="{{ nextStep.url }}">Next step for {{ who }} <span aria-hidden="true">&rarr;</span></a></li>
    {%- elif 'blueprint-consultants' in tags or 'blueprint-entities' in tags %}
        <li><a href="{{ collections['blueprint-both'][0].url }}">Next step for consultants and regulated entities <span aria-hidden="true">&rarr;</span></a></li>
    {%- endif %}
    </ul>
</nav>
{% endblock %}
